var SocialReach={url:null,tmp:0,sucessCallback:null,errorCallback:null,results:{total:0,tweets:null,facebook:{total:0,comments:null,likes:null,shares:null},plusOnes:null},fetch:{twitter:function(){if(null===SocialReach.url)console.error("No url.");else{var e="http://urls.api.twitter.com/1/urls/count.json?url="+SocialReach.url,l="jsonp_callback_"+Math.round(1e5*Math.random());window[l]=function(e){delete window[l],document.body.removeChild(a),SocialReach.results.tweets=parseInt(e.count),SocialReach.initCallback()};var a=document.createElement("script");a.src=e+(e.indexOf("?")>=0?"&":"?")+"callback="+l,document.body.appendChild(a)}},facebook:function(){if(null===SocialReach.url)console.error("No url.");else{var e=new JSONHttpRequest;e.onreadystatechange=function(){if(4===e.readyState&&null!=e.responseJSON){var l=e.responseJSON[0],a={total:parseInt(l.total_count),comments:parseInt(l.comment_count),shares:parseInt(l.share_count),likes:parseInt(l.like_count)};SocialReach.results.facebook=a,SocialReach.initCallback()}},e.onerror=function(){throw new Error("Error occured while fetching data from Facebook.")},e.open("GET","https://api.facebook.com/method/links.getStats?urls="+SocialReach.url+"&format=json",!0),e.send()}},googlePlus:function(){if(null===SocialReach.url)console.error("No url.");else{var e=new JSONHttpRequest;e.onreadystatechange=function(){if(4===e.readyState&&null!=e.responseJSON){var l=e.responseJSON.ones;l=null==l?0:l,SocialReach.results.plusOnes=parseInt(l),SocialReach.initCallback()}},e.onerror=function(){throw new Error("Error occured while fetching data from Google Plus.")},e.open("GET","http://labs.enji.se/share-reach/?url="+SocialReach.url,!0),e.send()}}},initCallback:function(){SocialReach.tmp+=1,3===SocialReach.tmp&&(SocialReach.results.total=SocialReach.results.facebook.total+SocialReach.results.plusOnes+SocialReach.results.tweets,SocialReach.successCallback(SocialReach.results),SocialReach.tmp=0)},get:function(e,l,a){null!==l&&(SocialReach.successCallback=l),null!==a&&(SocialReach.errorCallback=a),null===SocialReach.successCallback&&console.error("No success callback function."),SocialReach.url=encodeURIComponent(e),SocialReach.results={total:0,tweets:null,facebook:{total:0,comments:null,likes:null,shares:null},plusOnes:null};try{SocialReach.fetch.facebook(),SocialReach.fetch.twitter(),SocialReach.fetch.googlePlus()}catch(c){SocialReach.errorCallback(c)}}};